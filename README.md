# 📄 PDF to Editable PPTX (NotebookLM Optimized)

> **专为 NotebookLM 优化的 PDF 转 PPT 智能重构工具**
> An intelligent tool to convert static PDFs into fully editable PowerPoint slides, optimized for NotebookLM watermark removal and layout restoration.

## 📖 项目简介 (Introduction)

本项目是一个高保真文档转换引擎，能够将静态 PDF 文件重构为全要素可编辑的 PowerPoint (PPTX) 幻灯片。

**特别针对 Google NotebookLM 生成的文档进行了深度优化**。它能完美识别并擦除 "NotebookLM"、"Generated by Google" 等特定水印，同时解决 OCR 识别中常见的“排版破碎”和“背景脏乱”问题。利用计算机视觉技术，它能在保护图表和图片的完整性的同时，将正文重构为干净、整洁、可编辑的段落。

### ✨ 核心功能 (Key Features)

* **💧 NotebookLM 专项去水印 (Watermark Eraser)**
    * 内置针对 `notebooklm`、`generated by` 等关键词的**强力清洗模式**。
    * 利用 **OpenCV 强力膨胀**与**高斯羽化**技术，无痕擦除水印，背景过渡自然，绝无残留“脏点”。
* **🧩 智能排版重构 (Smart Layout)**
    * **段落合并**：自动分析行间距与左对齐特征，将碎片的 OCR 单行文本合并为完整的段落文本框，方便后期编辑。
    * **字体适配**：自动识别中英文，适配 **微软雅黑** (中文) 和 **Arial** (英文)，采用保守字号策略，确保文字不溢出。
* **🎨 工业级视觉修复 (Visual Restoration)**
    * **K-Means 聚类取色**：利用机器学习算法精准提取文字前景色（保留红头/蓝链），抵抗背景噪点干扰。
    * **图表避让**：独创**背景复杂度检测算法**，自动跳过流程图、插图和照片区域，确保原图画质 100% 无损。

## 🛠️ 安装指南 (Installation)

### 1. 环境准备
请确保安装 Python 3.8 或更高版本。

### 2. 安装 Poppler (关键步骤)
本项目依赖 `pdf2image` 库，必须先安装 Poppler 工具：
* **Windows**: 下载 [Poppler](https://github.com/oschwartz10612/poppler-windows/releases/)，解压并将 `bin` 文件夹路径添加到系统 **环境变量 (PATH)** 中。
* **Mac**: `brew install poppler`
* **Linux**: `sudo apt-get install poppler-utils`

### 3. 安装 Python 依赖
在项目根目录下运行：
```bash
pip install opencv-python paddlepaddle paddleocr pdf2image python-pptx
